# Azure AI Days

## Day1(Business Leaders)

企業が感じるAI導入の壁

- 明確なAI戦力の欠如

- 人材の欠如

- 企業内のサイロ化



### Deep Learning for DX

DLを用いることで、様々なデータ処理が高い精度で自動化できる。

活用事例

- 顔認識による表面体温の測定
- ワクチン開発(候補物質の絞り込み)
- 不良品検知
- 自動運搬機
- 溶接部の深傷検査
- ごみ処理におけるゴミ種類の識別
- ピンポイント農薬散布
- 収穫ロボット
- 水産養殖におけるスマート給餌
- 漫画の多言語自動翻訳



日本DL協会はDLのルール作りや研究会、人材育成(G/E検定)もやってる。

DX⇒デジタイゼーション+デジタライゼーション

DLはDXにおける中心的な技術(DLがなければDXで可能なものは従来型のものにとどまる)

![image-20210519132911940](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519132911940.png)



経営層の意識改革が必要⇒目標達成のためのリテラシー向上

JDLAによる支援

AI for Everyone(動画コンテンツ)



### Azure AI 

Azure上で展開されるAIサービスの総称

- Machine Learningサービス
- カスタマイズ可能なAIモデル
- シナリオ固有のサービス



利用パターン

- AIを利用したアプリ
  - AzureCognitiveService
- ナレッジマイニング
  - AzureCognitiveSearch
  - あらゆるデータタイプを抽出し整理
- 機械学習
  - AzureMachineLearning



AzureCognitiveService

- 視覚
- 音声
- 言語
- 意思決定



Cloud Skills Challengeで学習できる。





### ノーコードAIで実現するDX(Francfranc)

データ分析して、サービスに還元、事業成長につなげるAI-CRM基板



CRM活動の課題

- 顧客理解

その為には「分析」や「統計解析」の知識と人材が必要

⇒Azure



1. 予測モデル分析
   1. ゴールドの行動特性を列挙したい
   2. オンラインでの顧客の活動と店舗での行動をまとめ、機械学習で行動特性を分析する。
   3. 導き出した結果に再現性があるのかを調査
2. クラスター分析



###　画像による違反商品検知(メルカリ)

AIによる違反検知⇒違反スコアを計算し、カスタマーサポートで通知された商品を確認する。



検知手法

- MachineLearing
- 画像検知
- RuleBase



なぜAzureMachineLearningか

- GUIベース
- 転移学習により少ない学習データでモデル作成できる
- 独自のカスタムモジュールを組み込める
- サポートが手厚い

AzureMachineLearning大変だったとこ

- 画像データについてはAzureの他のサービスを使う必要がある
- 利用例が少ない



画像検知PoCのステップ

1. 対象商品の選定
2. 教師データの収集
   1. 正常な商品と違反商品の画像を準備する。
3. ラベリング
   1. AMLデータラベリング
4. モデル作成
   1. AML Designer(Training)
5. 判定処理
   1. AML Designer(Batch)

![image-20210519142950435](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519142950435.png)





課題

- 教師データが十分ある商品でしかできない
- Operation設計が難しい



### ナレッジマイニングソリューション(丹青社)

ナレッジ共有における課題

- コロナによりコミュニケーション量が減少し、ナレッジ共有しにくくなった

- 情報の絶対量が増え、管理が難しくなった

- インフォーマル(雑談とか)なコミュニケーションが減った

  

AzureCognitiveSearchを活用した取り組み

事業部横断で聞かう所の情報共有システムが必要だった。

要望

- 全文検索
- テキスト抽出しにくいファイルからも検索したい
- 管理者以外も権限設定したい
- 使いやすいUI
- 複数のファイル形式を一括で検索したい

![image-20210519145317888](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519145317888.png)









### デジタルマーケティング(カルビー)

カルビーのじゃがいも利用は国内で流通するじゃがいもの17%を占めてるらしい…



課題(デジタルデータを必要とする理由)

- アナログなキャンペーン(応募券を台紙に張って投函)
  - 収集できるデータは個人情報のみ
  - パーソナライズに使えない+キャンペーン終了後廃棄される
- 若年層へのアプローチ
- 消費者の満足度がわからない
- 商品に対する意見をもっと聞きたい
- 消費者へのマーケティングを行いたい。(消費者!=購買者)
- 消費者との距離が遠い。



デジタルデータを収集するアプローチ

- 折りパケ(画像認識で商品のパッケージを折りたたんだ形を読み取り、情報を抽出する)



CognitiveServicesの使いどころ

- Custom Vision
  - 折りパケの形状認識
- Computer Vision
  - シリアルコード読み取り



フルサーバレス DurableFunction

![image-20210519153224627](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519153224627.png)

CognitiveService活用において

- まずは動かしてみる
- 適切なAPIの選定
- データの前処理によって精度が左右される
- 複数の手法によって精度が左右される



![image-20210519154445200](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519154445200.png)





### 感情の可視化とリアルタイム演出の可能性(エイベックス)



Faceによる顔認識を用いた感情分析

検出可能な情報

- 年齢
- 性別
- 感情
- 眼鏡・マスク・髪の毛・化粧
- 顔の向き



AzureFaceの優位性

- 取得できる感情のバリエーションが多い
- 顔の検知制度とコストのバランスがいい
- 照明による影響が少ない
- マスクの有無を検知できる

AzureFaceの課題

- マスク着用時の感情が読み取りにくい
- 本人認証の精度がいまひとつ(セキュリティ用途の精度)



ライブ時に、その場にいる観衆の表情を時系列で分析

![image-20210519155503069](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519155503069.png)



![image-20210519155518013](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519155518013.png)



感情の可視化により、顧客の反応が分析可能に

- 映画・舞台・講演会
- 授業・講義
- レストラン・カフェ
- CM



HUMANOID DJ

観客の感情を解析し、～～その空間でしか体験できない音楽を作り出す。

![image-20210519160213319](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519160213319.png)





###  自社SaasサービスへのCognitiveService適用(富士フィルム)

IMAGE WORKS

写真・デザインの管理・共有クラウドサービス



アーキテクチャ

![image-20210519161448601](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210519161448601.png)





事例

- 選手名情報自動タグ付け機能
  - 球団の担当者が選手写真に対して名前等のラベル付けをしていた
  - それを自動化したもの
  - ComputerVision+CustomVision+Face
  - 試合中の公式記録とかと合わせて判定





### 所感

ITがメインじゃない会社(カルビーとかFrancfrancとか)でも、ノーコードとかCognitiveServiceを使用すれば、専門のプロフェッショナルがいなくても、十分にDLの恩恵を受けられる。(やりたいこと次第だけど。。)

機械学習のモデル作成とか無理くり頑張るよりも、既存のサービスに乗っかったほうがよさげ。

スクラッチにこだわらなくてもいい。ただより高度なニーズになってくると、自分らでモデル作ったりkaggleとかでカスタマイズしないといけなくなる。

データ分析において、一つの手法だけじゃなくて他のソースとも比較することで精度を上げることができる。

漠然とAIってとらえるんじゃなくて、何ができてできないか把握すること重要。







## Day2(Data Scientist)

### 自然言語処理と技術の変遷

自然言語処理のフロー

![image-20210520130424771](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520130424771.png)



～～



自然言語を活用した事例

- Bing Team
- rinna株式会社



#### NLP/QI分野での先端技術の活用事例(Bing Team)

近年のブラウザ検索はキーワードではなく、自然言語での検索が多用されるようになってきた。

⇒従来のキーワードベースの検索エンジンでは対応できなくなってきた。

⇒自然言語ベースの検索エンジンに置き換える。



成果物

言語理解と言語生成の2つの観点

リクエストクエリと関連性の高い結果を生成できる。



技術側面

膨大なトラフィックが走るサービスでDLをしようとすると、コストが膨大となる。

- DeepDpeed(効果的・効率的なモデル作学習ライブラリ)
  - 4つの特徴
    - ModelScale(1兆個のパラメータに対応)
    - Speed up(大規模モデルに対して、最大で10倍の速度で学習できる)
    - Democratize AI(個人でもAIライブラリの恩恵を受けられる)
    - Usabilty(数行で開発できる)

- ONNX Runtime(機械学習の統一的なフォーマットをもとにしたライブラリ)
  - 事例
    - Bing QnA(検索クエリに対するQA生成)
    - VisualSearch(似た画像検索)



#### 会話型AIの構築手法(rinna株式会社)

会話型AIの訓練手法

- 人間の話し方を学ばせる
  - 現実的でない
- 人間の会話データをモデル化する
  - ある質問に対して、この返答をする確立を定義
  - とかとか



既存の会話モデルの課題

- 下記を認識できない
- 感情
- 個人の背景
- カジュアル・フォーマル
- とか

⇒非言語部分が会話の中に言語化されていないため



現状は文脈のみから応答してる。

⇒

- データ選択フレームワーク
  - モデルごとに異なる学習をさせる
  - 嬉しいモデルはうれしい会話だけ
  - 悲しいモデルは悲しい会話だけ
  - 1つのモデルで1つのスタイルしか応答できない
- データアノテーションフレームワーク
  - 非言語情報をつけ加える
  - 丁寧な応答を。とか
  - 追加情報によりどんな応答をするか決める
  - データにアノテーションを付けるのは膨大な時間がかか
  - 1つのモデルで複数のスタイルに応答できる



### TexAInteligenceの技術(電通)

TexAInteligence

⇒文書活用AIソリューション



ソリューション内でのAzure活用実体

![image-20210520135151781](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520135151781.png)



特徴

- アプリ側
  - AI処理で時間がかかるので非同期処理が必要⇒RabbitMQで対応
- 機械学習側
  - DSVMの起動を自動制御



開発

- アジャイルを実施するにあたりAzureDevOpsを利用+Teams+VSCode

- コロナ後はフルリモート
- 有識者を社内横断的に集め完全内製化

![image-20210520135653496](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520135653496.png)



PyTorch

⇒Pythonの機械学習ライブラリ(OSS)



ISIDオリジナルALBERTモデル構築

課題

- パラメータ数が多くモデルサイズが大きい
- 限られた計算リソースでは学習福
- 推論時間が遅い
- ディスク量圧迫

⇒

- パラメータ数を10倍ほど削減
  - embeddingパラメータを因数分解
  - レイヤのパラメータを共通化
  - Sentence Order Prediction

⇒パラメータ数を減らせたものの、精度はよくなった



機能

- 文章類似検索
  - 文章ベクトル構築フェーズ
    - 文章をベクトル化し、インデックスとして保存
  - 推論/検索フェーズ

- 教師あり自動分類

- 文章要約



DLには下記フェーズがある

- 学習フェーズ
- 推論フェーズ





### Azureで賢く深める自然言語処理(SBテクノロジー)

NLPの概論

⇒人が日常的に使っている言葉をコンピュータで処理させること

　前処理が泥臭い(表記ゆれ、日本語の複雑さ、専門用語、、)

![image-20210520141927077](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520141927077.png)



![image-20210520142103015](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520142103015.png)



BERTの利用フロー

1. 事前学習(この部分が重たい内容だけど、有志が用意したモデルが多数公開されている)
2. 転移学習
3. 推論



課題

- 人が活動する中で自然に生み出されたデータ(チャットログとか。タグ付けされてない)
  - アンケートとってるけどフローコメントは分析してない
- 出てくる結果をどのように活用するのかイメージされてない
  - 分析の報告レポートを見てもよくわからない



比較の重要性

- 観点によってデータを分割し可視化すると理解できることが多い
- データやビジネス的側面からいい分割軸を見つけられるかが重要



分析でAzureを活用する意義

- 手軽にNLP結果を取得できる
- 気軽にWebアプリ公開できる
- BERTを利用しやすい(AzureML + Notebook)

![image-20210520143011332](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520143011332.png)

実案件

- ML Connect(IoTデータを活用し、AI解析の導入を早く手軽に提供する)
  - 電力需要や材料予測、異常感知が可能
- CogEra(アンケート集計分析ツール)
  - 自由回答も解析可能
  - 手軽に知見がなくても分析・可視化



NLP研究は活性化している。

可視化や分析のニーズが大多数。

Azureを利用すると分析活動が効率化できる。





### リアル・デジタルで価値を創造する～(ブリヂストン)

活用事例

- タイヤセンシングによる路面状態検知
  - 摩耗状態検知
    - 交換タイミングの通知
    - グリップ力に応じた自動車制御
  - 空気圧検知
  - 路面状態検知
    - 運転者への注意喚起
    - 路面状態に応じた自動車制御
    - リアルタイムに高速道路の管制局に通知することで、効率的な雪氷対策できる
- 空の移動を支えるタイヤ状態予測
  - 航空機のタイヤは非常に過酷な利用をされてる
  - 航空機560tに耐える+外気温変動
  - 摩耗予測シミュレーション
  - 機体のセンサーからデータ収集・解析
  - 摩耗・交換日予測する
  - 秘匿性高いから概要のみ
- 緊急ロードサービス最適化
  - トラブルからの早期復旧を目的に、サービスカーが現場到着するまでの移動時間を短縮しうるサービス提供店舗配置の最適化を検討
  - どこに店舗を配置すれば待ち時間少なく駆け付けられるか
  - 考慮すべき因子
    - 店舗と現場の距離
    - トラブルの種類
    - スペアタイヤの有無
    - 渋滞の起こりやすさ
    - etc
- 運送リューション強化
  - タイヤデータ+モビリティデータを収集し、さらなる顧客価値創造を目指す
  - タイヤのひずみデータを取得して、荷重・摩耗の情報へ変換
  - 色々やってます



CAISによる路面状態検知

⇒路面状態に応じて特徴的な波形が生じる(凍結/湿潤してる)

⇒波形をリアルタイムに解析する

？？？？？

![image-20210520145216717](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520145216717.png)



緊急ロードサービス最適化

？？？？？？？？？

![image-20210520150046142](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520150046142.png)





デジタル技術を統合することで、モノの提供だけでなく、サービスを提供し価値を生み出す。



なんでAzure？

- ドキュメントが充実
- サポートが手厚い



### 大量品目の需要予測(ジール・ニコン)

需要予測の課題

- SCMの起点であるため需要予測精度を求められる
- 自動化が難しい
- 精度が悪い
- 大量品目(発生ケース)の対応が難しい
- SCMの起点で業務を止められない

⇒定期的に予測する業務が発生してしまう。



AI適用の現実

- 予測負荷のものもあり、分類が必要
- 外れる前提の仕組みが必要
- 商品同士の関係を考慮する必要がある
- 随時データが更新されるため、新旧の予測値が必要
- 新商品対応

⇒これらは単純にAIにデータを食わせても対応できない。



AzureMLの活用ポイント

- Many Model Solution Accelerator
  - 大量モデルを生成するためのソリューション
  - 個々の店舗の売り上げ予測
  - 油田のメンテナンス予測
  - メリット
    - 並列実行
    - 自動スケール
    - 自動機械学習
    - カスタムスクリプト対応
- Automated ML
  - モデル生成のプロセウを自動化してくれる
- バージョン更新への対応が必要になってくる
- 一筋縄ではいかない(突発的・例外的データ)実データ対応が必要



なぜクラウドか

- 基幹システムに深くかかわるが、システム改修はハードルが高い
- 必要な機能がそろっており、素早くトライエラーを回せる
- 機械学習用のリソース(機器)を用意するのはコストがかかる



適用

- SIerとの協業的な開発

![image-20210520153609659](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520153609659.png)

![image-20210520153805241](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520153805241.png)



### データサイエンティストのためのMLOps(ブレインバッド)

データ分析のプロセスと課題

- 需要予測モデルを作ったが、外的要因で購買傾向ががらりと変わってしまった。(コロナとか)
  - 前処理のアプローチを変える必要がある
  - そもそもデータを集められないため、再構築が難しい
- 試したいアルゴリズムがあるが計算時間が莫大になりそう。計算リソースをすぐ増やしてほしいのに、稟議に時間がかかる。。
  - 自前のCPUマシンでは対応できない

![image-20210520155144475](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520155144475.png)





全体的流れ

![image-20210520155224979](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520155224979.png)

![image-20210520155542716](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520155542716.png)



プロセス事に担当する役割が変わる

![image-20210520160046115](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520160046115.png)

![image-20210520160227138](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520160227138.png)



MLOps

- 機械学習モデルのデータ作成～デプロイまでのサイクルを管理するフレームワーク
- データの準備、モデル、デプロイを一元管理
- 上記プロセスを自動化+自動テスト・監視

![image-20210520160333646](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520160333646.png)

AzureMachineLearning

- 各種サービスを統合的に利用し、機械学習を自動化する
- 機械学習モデルの開発期間を短縮する

![image-20210520160730146](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520160730146.png)

特徴

- 自動MLの仕組みが充実してる
- SDK豊富
- Synapse AnalyticsでのT-SQLによるモデル呼び出し



システム構成案

![image-20210520161252303](C:\Users\annor\AppData\Roaming\Typora\typora-user-images\image-20210520161252303.png)



### AIコンペティションが隠された才能を可視化する(SIGNATE・西日本旅客鉄道株式会社)

AIデータ活用に悩みを持っている組織がコンペティション運営に対して依頼を出し(データと賞金を提供)、一般のデータサイエンティストたちがコンペに参加し、モデル作成やデータ活用アイデアを提供する。

⇒スコアボードなどのゲーム要素が活発化させる

例

- 土砂崩れ検知
- 海氷検知
- 台風予測
- 自動運転チャレンジ
- etc

組織は低コストで精度の高いモデルを得られる。



AIコンペティションを活用した大企業における人材発掘・組織構築

西日本旅客鉄道株式会社のケース

- 新幹線車両台車部の着雪量予測コンペ
  - 社員が賞金もってった
  - 実際にAIモデル稼働中
- 人材発掘に活用





### 所感

データの前処理とかモデル作成とかは、データ分析の中でもかなり重たい部分。

ここをコンペとかSIerとかで外注するのも方法の一つとしてあげられる。

でもちゃんと社内で内製化するのも重要。(スキル蓄積の観点で。今のNECとのブロックチェーンもそうだけど。。)



当たり前だけどビジネス観点もわかってないとそもそも分析できない。(パラメータがわからない。比較対象・軸がわからない)ビジネス理解大事。

分析以前に、データ分析結果をどのように活用するのかイメージされてないとモデル作れない。

データを可視化するだけでなく、比較対象を用意し軸を設定することが大事。



Azure使えばデータ分析楽にできるけど、バージョン更新の対応が必要になったり、

自社でコントロールできない領域が増える。

⇒メリットデメリットを理解して使うことが重要





※画像の出典は各企業(表題記載)の登壇資料